# Бот для записи на уроки репетитора

Telegram-бот, через который ученики записываются на уроки, смотрят разборы ЕГЭ и могут просить помощь с домашкой.

## Возможности

**Для учеников:**
- Просмотр доступных уроков (`/lessons`) и запись по кнопке
- Список своих записей и закреплённых слотов (`/my`), отмена записи или слота
- Заявка на свободное время (репетитор создаёт урок — он появляется в «Записаться на урок»)
- Раздел ЕГЭ: 27 заданий с примерами решений (1–27)
- Помощь с домашкой (Yandex GPT), если настроен репетитором
- Материалы к урокам (`/materials`), если задана ссылка на канал

**Для репетитора (твой Telegram ID или добавленные админом):**
- Создание уроков: дата, время, название, повтор по неделям (`/add_lesson`)
- Расписание: период, кто записан, удаление уроков, ссылки на урок и на слоты
- Закрепление слотов за учеником (день недели + время), ссылка для слота, рассылка ссылки за минуту до времени
- Сводка на сегодня: уроки + закреплённые слоты на этот день недели (`/summary`)
- Заявки на свободное время от учеников
- Удалить все уроки (слоты остаются) или очистить всё расписание
- Режим **«Тестовый ученик»** — просмотр меню и действий от лица ученика

**Для администратора:**
- Выбор режима: админ / репетитор / ученик (тест)
- Добавление репетитора по Telegram ID (из бота)
- Скачать БД (резервная копия)
- Просмотр «Как видят ученики»

Данные хранятся в SQLite (`tutor_bot.db`). Репетиторы из конфига и добавленные через бота объединяются.

## Установка

1. Создай бота в [@BotFather](https://t.me/BotFather) (`/newbot`) и получи **токен**.

2. Узнай свой Telegram ID: [@userinfobot](https://t.me/userinfobot).

3. Зависимости:
   ```bash
   python3 -m venv .venv
   .venv/bin/pip install -r requirements.txt
   ```

4. Конфиг:
   ```bash
   cp config.example.py config.py
   ```
   В `config.py` укажи:
   - `BOT_TOKEN` — токен от BotFather
   - `ADMIN_USER_ID` и `TUTOR_USER_ID` (или `TUTOR_USER_IDS`) — твой ID
   - при необходимости: `BOT_TITLE`, `MATERIALS_CHANNEL_LINK`, `SUMMARY_DAILY_HOUR`, `LESSON_LINK`, `EGE_AUTHOR_TG`, `YANDEX_API_KEY`, `YANDEX_FOLDER_ID` (для помощи с домашкой)

5. Запуск:
   ```bash
   .venv/bin/python main.py
   ```
   Или: `./run.sh`

6. В фоне:
   - Логи в `bot.log`: `./run-background.sh`, остановить: `./stop-bot.sh`
   - Как служба (LaunchAgent): скопировать `com.tutorbot.plist` в `~/Library/LaunchAgents/`, затем:
     ```bash
     launchctl load ~/Library/LaunchAgents/com.tutorbot.plist
     ```
     Остановить: `launchctl unload ~/Library/LaunchAgents/com.tutorbot.plist`

Подробнее про деплой: `DEPLOY.md`, `RAILWAY.md`. Раздел ЕГЭ и загрузка заданий: `EGE.md`.
